# 406 Error - Not Acceptable

![](https://blog.kakaocdn.net/dn/cX0N4z/btr3eWu8a1Z/1XX0CRaDuqy9j3lSDOL55K/img.png)

## ì†Œê°œ ë°°ê²½
ìµœê·¼ ìˆœí™˜ ì°¸ì¡° ì—ëŸ¬ë¥¼ ë§Œë‚˜ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ API Response Dataë¥¼ DTOí™” ì‹œí‚¤ë‹¤ê°€ ë§Œë‚˜ê²Œ ëœ ì—ëŸ¬ì´ë‹¤.



ë‚œìƒ ì²˜ìŒë³´ëŠ” ì˜¤ë¥˜ì™€ í•¨ê»˜ ì•„ë˜ì™€ ê°™ì€ ERRORë„ ì•„ë‹Œ WARNì´ ì¶œë ¥ëœë‹¤.



**ì—ëŸ¬ë©”ì‹œì§€**

`2023-03-13 15:14:09.835  WARN 11696 --- [nio-8080-exec-7] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: Could not find acceptable representation]`




**PostMan Response**

![](https://blog.kakaocdn.net/dn/dcwQ6f/btr3HoiL1Gf/nuMQ2CCbznzc1UTW9uKczk/img.png)

ê°œë°œì„ í•˜ë©° ì²˜ìŒ ê²ªëŠ” ì—ëŸ¬ì˜€ê¸° ë•Œë¬¸ì— ìš°ì„ , ì—ëŸ¬ë¥¼ íŒŒì•…í•˜ê³ ì HTTP ì‘ë‹µ ì½”ë“œë¥¼ ì‚´í´ë³´ë˜ ë„ì¤‘ 406ì—ëŸ¬ì— ëŒ€í•œ ì„¤ëª…ì„ ë³´ê²Œë˜ì—ˆë‹¤.



## What is 406?


> ğŸ’¡ 406 Not Acceptable
> ì´ ì‘ë‹µì€ ì„œë²„ê°€ ì„œë²„ ì£¼ë„ ì½˜í…ì¸  í˜‘ìƒ ì„ ìˆ˜í–‰í•œ ì´í›„, ì‚¬ìš©ì ì—ì´ì „íŠ¸ì—ì„œ ì •í•´ì¤€ ê·œê²©ì— ë”°ë¥¸ ì–´ë– í•œ ì½˜í…ì¸ ë„ ì°¾ì§€ ì•Šì•˜ì„ ë•Œ, ì›¹ ì„œë²„ê°€ ë³´ëƒ…ë‹ˆë‹¤.


ì¼ë‹¨ ì„¤ëª…ë¶€í„° ì§ê´€ì ì´ì§€ ëª»í•˜ë‹¤.. ì„œë²„ ì£¼ë„ ì½˜í…ì¸  í˜‘ìƒ?



ì•Œì•„ë³´ë‹ˆ ì„œë²„ì—ì„œ ë°˜í™˜ ê°’ì„ ì •ì˜í•˜ì—¬ ì‚¬ì „ ì½˜í…ì¸  í˜‘ìƒ í—¤ë”ì— ì •ì˜ ëœ í—ˆìš© ê°€ëŠ¥í•œ ê°’ ëª©ë¡ê³¼ ì¼ì¹˜í•˜ëŠ” ì‘ë‹µì„ ìƒì„±í•˜ì—¬ ë°˜í™˜ê°’ì„ ì„ íƒí•˜ëŠ” ê²ƒì´ë¼ê³  í•œë‹¤.


ë‹¤ì‹œ ë³¸ë¡ ìœ¼ë¡œ ëŒì•„ì™€ì„œ ì €ë§ì˜ ëœ»ì€ ì„œë²„ì¸¡ì—ì„œ ì‘ë‹µì„ ì£¼ê¸°ìœ„í•´ ì‹œë„í–ˆìœ¼ë‚˜, Accept ë“±ì˜ í—¤ë”ì— ì í˜€ìˆëŠ” í˜•ì‹ì„ ìƒì„±í•´ ë‚¼ ìˆ˜ ì—†ì„ ê²½ìš° ë°œìƒí•œë‹¤ê³ í•œë‹¤.


ìŠ¤í”„ë§ë¶€íŠ¸ëŠ” Content-Typeì— ì„ ì–¸ëœ í˜•ì‹ìœ¼ë¡œ ë³€í™˜ì´ ë¶ˆê°€ëŠ¥ í•  ê²½ìš° ìœ„ì˜ ë¡œê·¸ì™€ í•¨ê»˜, 406 Not Acceptable ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¨ë‹¤. Springì—ì„œëŠ” ë°ì´í„°ë¥¼ HttpMessageConverterë¥¼ ì´ìš©í•´ì„œ ë³€í™˜í•œë‹¤.


í•´ë‹¹ ì‘ì—…ì€ ì•„ë˜ì™€ ê°™ì€ ìˆœì„œë¡œ ë™ì‘í•œë‹¤.

1. ì‘ë‹µí•˜ë ¤ëŠ” MediaTypeì„ ì‹ë³„í•œë‹¤.
2. ë“±ë¡ëœ HttpMessageConverterì—ì„œ MediaTypeìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³€í™˜ ì‹œí‚¬ ìˆ˜ ìˆëŠ” ë…€ì„ì„ ì°¾ëŠ”ë‹¤.
3. í•´ë‹¹ HttpMessageConverterë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë³€í™˜ì‹œí‚¨ë‹¤.

ê·¸ëŸ¼ ì´ê±¸ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ë°˜í™˜íƒ€ì…ì— ë¬¸ì œë¥¼ í•´ê²°í•˜ê±°ë‚˜ í—¤ë”ì˜ ìƒì„±ì´ ë§‰íˆëŠ” ì´ìœ ë¥¼ ì°¾ì•„ì•¼í•˜ëŠ”ë°, ì „ìì˜ ì´ìœ ëŠ” ë¬¸ì œê°€ ì—†ì„ ê²ƒì´ë¼ ìƒê°í•´ ê·¸ ì´ìœ ë¥¼ êµ¬ê¸€ë§í•˜ì˜€ê³  ê·¸ ê²°ê³¼ , ë‹¤ìŒ ì´ìœ ë“¤ì´ ì›ì¸ì´ ë  ìˆ˜ ìˆì—ˆë‹¤.


1. Jackson ë¼ì´ë¸ŒëŸ¬ì˜ ë¶€ì¬

í•´ë‹¹ ì›ì¸ì´ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ê¸°ì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ gradleì— ì¶”ê°€í•˜ëŠ” dependencyì¤‘ spring-boot-starter ì— ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ë˜ì–´ ìˆì–´ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ê²ƒê°™ì§„ì•Šì•˜ë‹¤.

implementation 'org.springframework.boot:spring-boot-starter'


2. ì ì ˆí•œ ë·° ë¦¬ì¡¸ë²„ê°€ ì—†ëŠ” ê²½ìš°

MVC í˜•íƒœì˜ í”„ë¡œì íŠ¸ì˜€ë‹¤ë©´ í•œë²ˆ ì¯¤ ì˜ì‹¬í•  ë§Œí•œ ì›ì¸ì´ì—ˆìœ¼ë‚˜ ë‚˜ëŠ” í˜„ì¬ Restful Serverë¥¼ êµ¬ì¶• í•˜ì˜€ê¸°ì— ì´ ë˜í•œ ì§ì ‘ì ì¸ ì›ì¸ì€ ì•„ë‹ ê²ƒì´ë¼ íŒë‹¨í–ˆë‹¤.



3. ì¸ì¦ë˜ì§€ ì•Šì€ ìš”ì²­ì˜ ê²½ìš°

ì´ëŠ” í˜„ì¬ êµ¬ì„±ì¤‘ì¸ í”„ë¡œì íŠ¸ê°€ JWT í† í° ì „ëµì„ ì‚¬ìš©í•˜ì—¬ Custom Filterë¥¼ êµ¬ì„±í•´ ë§Œì•½, í—ˆê°€ë˜ì§€ ì•Šì€ ìš”ì²­ì˜ ê²½ìš° 401ì„ ë°˜í™˜í•˜ë„ë¡ ë§Œë“¤ì—ˆê¸°ì— ì´ ë˜í•œ ì˜ì‹¬í•  ì—¬ì§€ê°€ ì—†ì—ˆë‹¤. (ì‹¤ì œë¡œ Filterì— logging ì‘ì—…ì„ í•˜ë©° í™•ì¸í•œ ê²°ê³¼ ë¬¸ì œê°€ ì—†ì—ˆë‹¤.)



4. ë°˜í™˜í•˜ëŠ” Respons Entity í˜¹ì€ DTOì— Getterê°€ ì—†ëŠ” ê²½ìš°

ë§¨ ì²˜ìŒì—ëŠ” ë‹¹í™©í–ˆë‹¤.

"ì´ëŸ° ë‹¨ìˆœí•œ ì´ìœ ë¡œ ì˜¤ë¥˜ê°€ ë‚œë‹¤ê³ ?" ìƒê°í–ˆê¸° ë•Œë¬¸ì´ë‹¤.

ì´ ì›ì¸ì„ ì•Œ ìˆ˜ ìˆì—ˆë˜ StackOverFlow ì§ˆë¬¸ì„ ë³´ë©´ ë„ì›€ì´ ë˜ëŠ” ë‹µë³€ì´ í•˜ë‚˜ìˆì—ˆë‹¤.



> I believe by default auto discovery is on and will try to discover your getters. You can disable it with
> @JsonAutoDetect(getterVisibility=Visibility.NONE)
> , and in your example will result in
> [].
í•´ì„í•˜ìë©´ ê¸°ë³¸ì ìœ¼ë¡œ Jacksonì˜ ìë™ ê²€ìƒ‰ì´ ì¼œì ¸ ìˆê³  ê²Œí„°ë¥¼ ê²€ìƒ‰í•˜ë ¤ê³  ì‹œë„í•  ê²ƒì´ë©° @JsonAutoDetect(getterVisibility=Visibility.NONE)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.



ì›ì¸ ë¶„ì„
ì•„ê¹Œ Acceptì™€ ê°™ì€ í—¤ë”ì— ì‘ì„±ëœ í˜•ì‹ì„ ìƒì„±í•˜ì§€ ëª»í•  ë•Œ 406ì—ëŸ¬ë¥¼ ë¦¬í„´í•œë‹¤ê³  ë§í–ˆëŠ”ë° Aceeptê°€ application/jsonë¡œ ì„¤ì •ë˜ì–´ìˆì–´ ì„œë²„ëŠ” ë°˜ë“œì‹œ JSON í˜•íƒœì˜ Responseë¥¼ ë°˜í™˜í•´ì•¼í•œë‹¤.



ê·¸ëŸ°ë° ì´ë•Œ JSON í˜•íƒœë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì—ì„œ spring-boot-starterì— ì†í•´ìˆëŠ” Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì´ìš©ë˜ëŠ”ë° ì´ë•Œ,
ë°˜í™˜ ê°ì²´ì— '@Getter' ì–´ë…¸í…Œì´ì…˜ì„ ì œê±°ë˜ì–´ ìˆë‹¤ë©´ JSON ê°ì²´ë¥¼ ìƒì„±í•˜ì§€ ëª»í•˜ê³  406ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ê²Œ ëœê²ƒì´ë‹¤.



ê¸°ë³¸ì ìœ¼ë¡œ ìš°ë¦¬ê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ Responseë¥¼ ì£¼ê¸°ìœ„í•´ Response Entity ë˜ëŠ” DTOë¥¼ ì‚¬ìš©í•˜ê³ , ì´ëŠ” ëª¨ë‘ application/json íƒ€ì…ì´ë‹¤. ì´ë¥¼ êµ¬ì„±í•  ë•Œ Getterë¥¼ í†µí•´ í•„ë“œê°’ì„ ê°€ì ¸ì™€ ì¬êµ¬ì„±í•˜ì—¬ ìµœì¢…ì ìœ¼ë¡œ JSON ê°ì²´ë¥¼ ë§Œë“œëŠ”ë° Getterê°€ ì œê±°ë˜ì–´ìˆìœ¼ë‹ˆ ë‹¹ì—°íˆ ë˜ì§€ ì•Šì•˜ë˜ ê²ƒì´ë‹¤.



ë¬¸ì œì½”ë“œ
DTO ì‚¬ìš© ì»¨íŠ¸ë¡¤ëŸ¬

```java
@GetMapping("/userInfo/one")
public ResponseEntity<?> getOneOfUserInfo(@RequestHeader("userInfo")String accessToken){
System.out.println("userInfoaccess="+accessToken);
String user_Nickname = jwtService.extractNickname(accessToken).get();
log.info("user_Nickname+"+user_Nickname);
MemberResponseDTO memberResponseDTO = memberService.getMemberInfoByNickname(user_Nickname).toDTO();

return new ResponseEntity<>(memberResponseDTO, HttpStatus.OK);
}
```

í•´ë‹¹ ì½”ë“œë¥¼ ë³´ë©´ membrServiceë¼ëŠ” Service Layerì—ì„œ getMemberInfoByNicknameì´ë¼ëŠ” ë©”ì†Œë“œë¥¼ í†µí•´ Member Entityë¥¼ ë°˜í™˜í•˜ê³  MemberEntity ë‚´ë¶€ì— toDTO()ë¼ëŠ” ë¹Œë”ë¥¼ ë§Œë“¤ì–´ ì´ë¥¼ DTOí™”ì‹œí‚¨ë‹¤.


**MemberSocial Entity ì¼ë¶€**
```java
@Entity
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@AllArgsConstructor
@Getter
@Builder
public class MemberSocial extends BaseEntity {

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Long member_seq;


	...

public MemberResponseDTO toDTO(){
return MemberResponseDTO
.builder()
.member_seq(member_seq)
.authToken(authToken)
.member_imgUrl(member_imgUrl)
.email(email)
.nickname(nickname)
.oauthId(oauthId)
.socialType(socialType)
.refreshToken(refreshToken)
.role(role)
.build();
}
}

```


**ì›ë˜ì˜ DTO ìƒíƒœ**

```java
@Builder
public class MemberResponseDTO {
private Long member_seq;

private String email;

private String nickname;

private String member_imgUrl;

private String oauthId;

private MemberRole role;

private SocialType socialType;

private String authToken;

private String refreshToken;

}

```


ì´ë¥¼ Lombok ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ @Getter ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ í•´ê²°í•˜ì˜€ë‹¤.

```java
package project.mogakco.domain.member.dto;

import lombok.Builder;
import lombok.Getter;
import lombok.Setter;
import project.mogakco.domain.member.entity.member.MemberRole;
import project.mogakco.domain.member.entity.member.SocialType;


@Builder
@Getter
public class MemberResponseDTO {
private Long member_seq;

private String email;

private String nickname;

private String member_imgUrl;

private String oauthId;

private MemberRole role;

private SocialType socialType;

private String authToken;

private String refreshToken;

}
```


ê²°ë¡ 
ë¬´í•œì°¸ì¡°ë¥¼ í•´ê²°í•˜ë‹¤ ìš°ì—°íˆ ë§Œë‚œì—ëŸ¬ì´ì§€ë§Œ, ìƒˆì‚¼ìŠ¤ëŸ½ê²Œ Spring Frameworkì„ ì‚¬ìš©í•˜ë©´ì„œë„ ì •ë§ ë‚´ë¶€ì  ë™ì‘ì›ë¦¬ë¥¼ ì˜ì•Œì§€ëª»í•˜ê³  ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ë‹¤.



ì—­ì‹œë‚˜ ëª…ì„¸ì™€ ë¬¸ì„œëŠ” í•­ìƒ ì°¸ê³ í•˜ë©° ê³µë¶€ë¥¼ í•´ì•¼í•˜ëŠ” ê²ƒ ê°™ë‹¤.